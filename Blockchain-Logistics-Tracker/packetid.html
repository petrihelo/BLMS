<!DOCTYPE html>
<html lang="en">
<head>
  <title>Packet</title>
  <meta charset="utf-8">
  <!-- < meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1"> -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <script type="text/javascript" src="https://code.jquery.com/jquery-2.2.3.js"></script>
        <link href="css/bootstrap.min.css" rel="stylesheet">
		
        <link href="css/style.css" rel="stylesheet">
		
<!-- 
  <script type="text/javascript" src="https://code.jquery.com/jquery-2.2.3.js"></script>
  <link href="https://www.cc.puv.fi/~e1401168/ekasivu/barcode2/css/bootstrap.min.css" rel="stylesheet">	
  <link href="https://www.cc.puv.fi/~e1401168/ekasivu/barcode2/css/style.css" rel="stylesheet"> -->
  <style>
  * {
    box-sizing: border-box;
   -webkit-box-sizing
   -moz-box-sizing: border-box;
   
}
  body{
    margin:50px 0; 
    padding:0px;
    text-align:center;
	
  } 
  .btn{
	font-size:25px;
	margin-bottom:12px;
	border-radius: 5px;
	padding:7px 5px;
	
  }
    .glyphicon {
      font-size: 40px;
	    float:right;
}
  .input{
    width:230px;
    height: 50px;
    font-size:18px;
  
  }
    .input:focus {
    outline: #4CAF50 solid 1px;    
}
  h2{
    margin-top: 40px;
    margin-right:93px;
    font-size:50px;
 
  }
@media only screen and (orientation: landscape) {
 .btn{
    font-size:40px;
    margin-bottom:23px;
    border-radius: 5px;
	padding:8px 8px;

  } 
    h2{
    margin-top: 40px;
    font-size:65px;
 
  }
  body{
    margin:50px 0; 
    padding:0px;
    text-align:center;
	
  }
  .input{
    width:75%;
	height: 75px;
	font-size:40px;
	
  }
    .input:focus {
    outline: #4CAF50 solid 1px;    
}
    .koko{
      margin-top:-44px;

  }
    .glyphicon {
      font-size: 40px;
	    float:right;
}
}
    </style>

</head>
<body>
 
<div class="koko">
<nav class="navbar navbar-light menu" style="background-color: #e3f2fd;">
      <a href="http://www.cc.puv.fi/~e1401168/ekasivu/barcode2/mainmenu.html"><span class="glyphicon glyphicon-home"></span></a>
	  
    <div class="container-fluid" >
      <div class="navbar-header">
        <a class="navbar-brand" href="http://www.cc.puv.fi/~e1401168/ekasivu/barcode2/mainmenu.html">Blockchain Logistics Tracker</a>
		<div class="blurred" id="demo" style="display:none">   

        <div class="container" id="QR-Code">
            <div class="panel panel-info">
                <div class="panel-heading">
                    <div class="navbar-form navbar-left" >
               
                    </div>
                    <div class="navbar-form navbar-right">
                        <select style="display:none" class="form-control" id="camera-select"><option value="91574bf40aa5d3ceb5fcd59b95d56c4636dbd3c4382e51de6a99d7f764fb9d4b">Integrated Webcam (0bda:5650)</option><option value="a7c5c33e7073735017901269334438e4be1dd46738972a073f1dc4f2b6996201">FaceCam 1320 (0458:707b)</option></select>

                    </div>
                </div>
                <div class="panel-body text-center" >
                     <div class="col-md-6" >  <!--Barcode made by andrastoth -->
                        <div style="display:none" class="well" style="position: relative;display: inline-block;">
                            <canvas style="display:none" width="320" height="240" id="webcodecam-canvas"></canvas>
                            <div class="scanner-laser laser-rightBottom" style="opacity: 0.5;"></div>
                            <div class="scanner-laser laser-rightTop" style="opacity: 0.5;"></div>
                            <div class="scanner-laser laser-leftBottom" style="opacity: 0.5;"></div>
                            <div class="scanner-laser laser-leftTop" style="opacity: 0.5;"></div>
                        </div>
                        <div style="display:none" class="well" style="width: 100%;"> 
                            <label id="zoom-value" width="100">Zoom: 2</label>
                            <input id="zoom" onchange="Page.changeZoom();" type="range" min="10" max="30" value="20">
                            <label id="brightness-value" width="100">Brightness: 0</label>
                            <input id="brightness" onchange="Page.changeBrightness();" type="range" min="0" max="128" value="0">
                            <label id="contrast-value" width="100">Contrast: 0</label>
                            <input id="contrast" onchange="Page.changeContrast();" type="range" min="0" max="64" value="0">
                            <label id="threshold-value" width="100">Threshold: 0</label>
                            <input id="threshold" onchange="Page.changeThreshold();" type="range" min="0" max="512" value="0">
                            <label id="sharpness-value" width="100">Sharpness: off</label>
                            <input id="sharpness" onchange="Page.changeSharpness();" type="checkbox">
                            <label id="grayscale-value" width="100">grayscale: off</label>
                            <input id="grayscale" onchange="Page.changeGrayscale();" type="checkbox">
                            <br>
                            <label id="flipVertical-value" width="100">Flip Vertical: off</label>
                            <input id="flipVertical" onchange="Page.changeVertical();" type="checkbox">
                            <label id="flipHorizontal-value" width="100">Flip Horizontal: off</label>
                            <input id="flipHorizontal" onchange="Page.changeHorizontal();" type="checkbox">
                        </div>
                    </div >
                    <div class="col-md-6">
                        <div class="thumbnail" id="result">
                            <div class="well" style="overflow: hidden;">
                                <img style="display:none" width="320" height="240" id="scanned-img" src="">
                            </div>

                        </div>
                    </div>
                </div>
                <div class="panel-footer">
                    


            </div>
        </div>
    </div></div> 
      </div> </div>
	      <h2 id="clientMessage" class="clientMessage"></h2>
  <h2>Packet ID</h2>
    <form action="/add" method="post" id="addForm">
    <div class="form-group ">
	<label for="name"></label>
      <input type="search" id="packetID" name="packetID"  list="predictive" class="input"   required autocomplete="packetID" placeholder="" autofocus>
	          <datalist id="predictive"></datalist>

	   <button type="button" class="btn btn-primary" onclick=getLocation()>Submit</button>
	  
	   			            <!-- <p id="scanned-QR" ></p> -->

	           <input  type="hidden" name="userName" id="user" value="">
			                           <div class="form-group">
                            <input style="display:none" id="image-url" type="text" class="form-control" placeholder="Image url">
                            <button  title="Decode Image" class="btn btn-default btn-sm" id="decode-img" type="button" data-toggle="tooltip"><span class="glyphicon glyphicon-barcode"></span></button>
                            <button style="display:none" title="Image shoot" class="btn btn-info btn-sm disabled" id="grab-img" type="button" data-toggle="tooltip"><span class="glyphicon glyphicon-picture"></span></button>
                            <button style="display:none"  title="Play" class="btn btn-success btn-sm" id="play" type="button" data-toggle="tooltip"><span class="glyphicon glyphicon-play"></span></button>
                            <button style="display:none" title="Pause" class="btn btn-warning btn-sm" id="pause" type="button" data-toggle="tooltip"><span class="glyphicon glyphicon-pause"></span></button>
                            <button style="display:none" title="Stop streams" class="btn btn-danger btn-sm" id="stop" type="button" data-toggle="tooltip"><span class="glyphicon glyphicon-stop" ></span></button>
                         </div>
        <input name="companyName" type="hidden" id="company" value="">
        <input name="latitudeClient"  id="lat" type="hidden">
        <input name="longitudeClient"  id="lon" type="hidden">
    </div>
	      <button type="submit" style="color: transparent; background-color: transparent; border-color: transparent; cursor: default;" id="submitButton" disabled=true>Loading location...</button>
  </form>   
      <div class="table-responsive">
      <table id="id01" class="table"></table>
    </div>
	</div>
	<!--
		    <script type="text/javascript" src="https://www.cc.puv.fi/~e1401168/ekasivu/barcode2/js/jquery.js"></script>
	    <script type="text/javascript" src="https://www.cc.puv.fi/~e1401168/ekasivu/barcode2/js/mainjquery.js"></script>
	    <script type="text/javascript" src="https://www.cc.puv.fi/~e1401168/ekasivu/barcode2/js/DecoderWorker.js"></script>
        <script type="text/javascript" src="https://www.cc.puv.fi/~e1401168/ekasivu/barcode2/js/filereader.js"></script>
        <script type="text/javascript" src="https://www.cc.puv.fi/~e1401168/ekasivu/barcode2/js/qrcodelib.js"></script>
	    <script type="text/javascript" src="https://www.cc.puv.fi/~e1401168/ekasivu/barcode2/js/webcodecamjquery.js"></script>
        <script type="text/javascript" src="https://www.cc.puv.fi/~e1401168/ekasivu/barcode2/js/webcodecamjs.js"></script>
        <script type="text/javascript" src="https://www.cc.puv.fi/~e1401168/ekasivu/barcode2/js/main.js"></script>
	-->
	    <script type="text/javascript" src="js/DecoderWorker.js"></script>
        <script type="text/javascript" src="js/filereader.js"></script>
        <script type="text/javascript" src="js/qrcodelib.js"></script>
        <script type="text/javascript" src="js/webcodecamjs.js"></script>
        <script type="text/javascript" src="js/main.js"></script>
<script>
  var suggestions=";vbsfb;Thanhs packet;2409;1511-1221;777;dht;1411-1422;presentation?;1411-249;5541;162;Thanh123;13112017";
  suggestions=suggestions.split(';');
  //var retrievedPackets='';
  var submitButton = document.getElementById("submitButton");

  var autofillCompanyname=localStorage.getItem("companyName");
  var autofillUsername=localStorage.getItem("userName");
  if(autofillUsername!=null&&autofillCompanyname!=null)
  {
    document.getElementById("user").value=autofillUsername;
    document.getElementById("company").value=autofillCompanyname;
  }

  for(var suggestIndex=0;suggestIndex<suggestions.length;suggestIndex+=1)
  {
    if(suggestions[suggestIndex]!=null&&suggestions[suggestIndex]!="")
    {
      document.getElementById("predictive").innerHTML+="<option value="+suggestions[suggestIndex]+">";
    }
  }

  /*
  function getName()
  {
    document.getElementById("user").value =document.getElementById("userInput").value;
    document.getElementById("company").value =document.getElementById("companyInput").value;
    localStorage.setItem("userName",document.getElementById("userInput").value);
    localStorage.setItem("companyName",document.getElementById("companyInput").value);
  }
  */

  function getLocation()
  {
    //getName(); log in moved to separate html
    submitButton.style.color="blue";
    if (navigator.geolocation && document.getElementById("packetID").value!="")
    {
      navigator.geolocation.getCurrentPosition(showPosition);
    }
    else
    {
      //innerHTML = "Geolocation is not supported by this browser.";
      alert("Location not supported or invalid Packet ID");
      location.reload();
    }
  }

  function showPosition(position) {
    var showPositionLoop = setInterval(function()
    {
      if(position.coords.latitude.toFixed!=null && position.coords.longitude!=null)
      {
        document.getElementById("lat").value =position.coords.latitude;
        document.getElementById("lon").value =position.coords.longitude;
        clearInterval(showPositionLoop);
        submitButton.disabled=false;
        submitButton.click();
      }
    },100);
  }

 
(function(m){if(!(/iPhone|iPad|iPod/.test(navigator.platform)&&navigator.userAgent.indexOf("AppleWebKit")>-1)){return}var l=m.document;if(!l.querySelector){return}var n=l.querySelector("meta[name=viewport]"),a=n&&n.getAttribute("content"),k=a+",maximum-scale=1",d=a+",maximum-scale=10",g=true,j,i,h,c;if(!n){return}function f(){n.setAttribute("content",d);g=true}function b(){n.setAttribute("content",k);g=false}function e(o){c=o.accelerationIncludingGravity;j=Math.abs(c.x);i=Math.abs(c.y);h=Math.abs(c.z);if(!m.orientation&&(j>7||((h>6&&i<8||h<8&&i>6)&&j>5))){if(g){b()}}else{if(!g){f()}}}m.addEventListener("orientationchange",f,false);m.addEventListener("devicemotion",e,false)})(this);
//setTimeout(function(){ document.querySelector("meta[name=viewport]").setAttribute('content','width=device-width, initial-scale=1');}, 500); if problem with device orientation use this.
// window.onorientationchange = function(){window.location.reload();};
  </script>
  

</body>
</html>
